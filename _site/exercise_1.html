<!DOCTYPE html>
<html>
  <head>
    <title>BigDataClass.org | Exercise 1: Tf-Idf (Java)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->

    <!-- Latest compiled and minified CSS -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css">

    <!-- Optional theme -->
    <link rel="stylesheet" href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap-theme.min.css">

    <link rel="stylesheet" href="/css/font-awesome/css/font-awesome.min.css">
    
    <link rel="stylesheet" href="/css/main.css">

    <!-- Latest compiled and minified JavaScript -->
    <script src="/js/jquery.js"></script>
    <script src="/js/bootstrap.js"></script>
    <script src="/js/subnav.js"></script>

    <script src="/js/main.js"></script>

  </head>
  <body onload="main()">

 <div class="navbar navbar-inverse navbar-fixed-top">
  <a href="https://github.com/stratosphere/bigdataclass.org">
    <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_gray_6d6d6d.png" alt="Fork me on GitHub">
    </a>

      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <a class="navbar-brand" href="/index.html"><i class="icon-home"></i> BigDataClass.org</a>
        </div>
        <div class="collapse navbar-collapse">
          <ul class="nav navbar-nav">
            <li><a href="/gettingstarted.html">Getting Started</a></li>
            <li><a href="/exercise_1.html"><strong>Exercise 1</strong>: Tf-Idf (Java)</a></li>
            <li><a href="/exercise_2.html"><strong>Exercise 2</strong>: Tf-Idf (Scala)</a></li>
          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </div>
    <div class="container content">
<div class="subnav" id="navbar-inner">
  <ul class="nav nav-pills">
    <li class=""><a href="#overview">Overview</a></li><li class=""><a href="#task1">1: Document Frequency</a></li><li class=""><a href="#task2"">2: Term Frequency</a></li><li class=""><a href="#task3">3: Join</a></li><li class=""><a href="#task4">4: WeightVector per Document</a></li>
  </ul>
</div>

<div>
<p><section id="overview"></p>

<h2>Overview</h2>

<p>In this programming assignment, you are going to compute <a href="http://en.wikipedia.org/wiki/Tf%E2%80%93idf">tf-idf</a> weights for a small dataset in Stratosphere. You will be introduced to the main concepts in the respective subtasks.</p>

<p>The following figure gives an overview of what we are going to do in each task:</p>

<p><img src="plan.svg" onerror="this.onerror=null; this.src='plan.svg'" class="img-rounded"></p>

<p><button class="btn btn-primary" id="show-plan-example">Show more detailed example</button></p>

<p><img id="plan-example" style="display:none;" src="plan-example.svg" onerror="this.onerror=null; this.src='plan-example.svg'" class="img-rounded"></p>

<p></section></p>

<p><section id="task1"></p>

<h2>Task 1: Document Frequency</h2>

<div class="progress">
  <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 1%;">
    <span class="sr-only">1% Complete</span>
  </div>
</div>

<p>You are first going to calculate the document frequency. That is, in how many documents each distinct word occurs.
So if a document contains a word three times, it is counted only once for this document. But if another document contains the word as well, the overall frequency is two.</p>

<p>Besides this, you need to do some data cleansing on the input data. That is, accept only terms (words) that are alphanumerical. There is also a list of stopwords (provided by us) which should be rejected.</p>

<p>To achieve this, you need to implement a Mapper and a Reducer. The input file is a regular text file that contains a line for each document.
The schema of the input file looks like this:
<code>
docid, document contents
</code>
The Mapper is called with the documents. So each call of the <code>map()</code> function gets one line (e.g. a document).</p>

<p>You need to do the following in the Mapper: First, split the input line so that only alphanumerical words are accepted. Remember to remove the document id. </p>

<p>Then, check if the individual terms are in the HashSet (<code>Util.STOP_WORDS</code>) of stopwords. You do not need to do additional extra checks because we already checked the input.</p>

<p>You should also use a <a href="http://docs.oracle.com/javase/7/docs/api/java/util/HashSet.html">HashSet</a> to check if the word already occured for the given document. Remember, count each word only once here.</p>

<p>The last step is to emit all words with a frequency count of 1. Use a <code>Record</code> with two fields. Set the word as the first field and the count (always 1) as the second field.
You have to use the build-in datatypes for <code>String</code> and <code>int</code> (<code>StringValue</code> and <code>IntValue</code>).
Use the output collector (second argument of <code>map()</code>) to emit the <code>Record</code></p>

<p>Use the provided <code>main()</code> method to test your code.</p>

<p>Task #1 is quite similar to the classical WordCount example, which is something like the &quot;Hello World&quot; of Big Data.
</section></p>

<p><a name="task2"></a>
<h2 class="page-header">Task 2: Term Frequency</h2>
<div class="progress">
  <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 20%;">
    <span class="sr-only">20% Complete</span>
  </div>
</div></p>

<p>Implement a second Mapper that also reads in the documents from the same file. 
This time, the output tuples shall look like this <code>(docid, word, frequency)</code>.</p>

<p>You should use the same splitter for the input line as in Task #1. But this time, use the <code>docid</code>. 
Use a HashMap to identify the frequency of each word in the document.</p>

<p><section id="task3"></p>

<h2>Task 3: Join</h2>

<div class="progress">
  <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 40%;">
    <span class="sr-only">40% Complete</span>
  </div>
</div>

<p>This task uses a new Operator: Join. It has two inputs, namely the outputs from the previous tasks.</p>

<p>In the <code>JoinFunction</code>, the <code>join()</code> method has two parameters, a <code>Record</code> from each input that matched on the term.</p>

<p>The following pseudo code describes what the join does.</p>
<div class="highlight"><pre><code class="language-javascript" data-lang="javascript"><span class="nx">join</span><span class="p">(</span> <span class="p">(</span><span class="nx">word</span><span class="p">,</span> <span class="nx">df</span><span class="p">),</span> <span class="p">(</span><span class="nx">docid</span><span class="p">,</span> <span class="nx">word</span><span class="p">,</span> <span class="nx">tf</span><span class="p">))</span> <span class="p">{</span>
    <span class="nx">tf_idf</span><span class="p">(</span><span class="nx">word</span><span class="p">)</span> <span class="o">=</span> <span class="nx">tf</span> <span class="o">*</span> <span class="nx">log</span> <span class="p">[</span><span class="nx">Util</span><span class="p">.</span><span class="nx">NUM_DOCUMENTS</span><span class="o">/</span><span class="nx">df</span><span class="p">]</span>
    <span class="k">return</span> <span class="p">(</span><span class="nx">docid</span><span class="p">,</span> <span class="nx">word</span><span class="p">,</span> <span class="nx">tf_idf</span><span class="p">(</span><span class="nx">word</span><span class="p">))</span>
<span class="p">}</span>
</code></pre></div>
<p></section></p>

<p><section id="task4">
<h2 class="page-header">Task 4: Custom Type and Weights per Document</h2></p>

<div class="progress">
  <div class="progress-bar" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 60%;">
    <span class="sr-only">60% Complete</span>
  </div>
</div>

<h3>Preparation</h3>

<p>Stratosphere comes with a bunch of build-in datatypes. For this assignment, you are going to implement your own. This task is a preparation for the last one. We want to store a <code>WeightVector</code>.
The datatype has a <code>add(String, double)</code> method to store the weight of each word.</p>

<p>The main task here is implementing the data de/serialization methods which are used before transferring the data through the network or to disk.</p>

<p>We recommend to store each <code>(String, double)</code> pair in two lists.</p>

<h3>Term Weights per Document</h3>

<p>This reduce task takes the output of the join and groups it by the document ids (<code>docid</code>).
Write the document id and the terms including their weight into the <code>WeightVector</code> you have created in the previous task.</p>

<p></section></p>

<h2>Congratulations!</h2>

<div class="progress">
  <div class="progress-bar progress-bar-success" role="progressbar" aria-valuenow="60" aria-valuemin="0" aria-valuemax="100" style="width: 100%;">
    <span class="sr-only">100% Complete</span>
  </div>
</div>

</div>

<hr style="margin-top:80px;margin-bottom:20px;">

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'bigdataclass'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
<a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>
    


      <p class="text-right"><a href="/legal.html">Legal</a></p>

    </div>




    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-44453418-2']);
    _gaq.push(['_gat._anonymizeIp']);
    _gaq.push(['_trackPageview']);
    (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true; 

    ga.src = ('https:' == document.location.protocol ? 'https://' : 'http://') + 'stats.g.doubleclick.net/dc.js';

    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>

  </body>
</html>